/**
 * 
 */
package com.pramati.imaginea.bObj;

import java.io.IOException;
import java.util.ArrayList;
import java.util.concurrent.BlockingQueue;

import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.jsoup.select.Elements;

/**fetch links from given url and put in the queue
 * @author anandu
 *
 */
public class Producer implements Runnable {

	private BlockingQueue<String> glinkQueue = null;
	private String gUrl;
	
	public Producer(BlockingQueue<String> queue,String url) {
		this.glinkQueue = queue;
		this.gUrl = url;
	}

	@Override
	public void run() {
		// TODO Auto-generated method stub
		try {
			Document doc = Jsoup.connect(gUrl).get();
			Elements links = doc.select("a[href]");
			for (Element link : links) {
				if (links.attr("href").contains("@")) {
					glinkQueue.put(new HttpWebpage(gUrl + "/ajax/" + link.attr("href")));
				}
			}
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (InterruptedException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}
	public void shutDown() throws InterruptedException {
		glinkQueue.put(null);
		}
}
